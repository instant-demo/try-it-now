{"id":"demo-multi-plexer-46z","title":"Container health check fails for nginx:alpine in Docker","description":"During E2E testing, discovered that nginx:alpine containers start but fail the HealthCheck in pool/impl.go. Container shows as 'unhealthy' in docker ps. HTTP requests to the mapped port (e.g., localhost:32919) fail with connection refused.\n\nSymptoms:\n- Container starts successfully\n- Port mapping shows in 'docker ps' (0.0.0.0:32919-\u003e80/tcp)\n- curl to port returns connection refused\n- Pool replenisher logs: 'container failed health check: timeout waiting for container to be ready'\n\nInvestigation needed:\n1. Check if nginx is actually starting inside container\n2. Verify Docker network configuration (deployments_demo-net)\n3. Check if port binding is working correctly\n4. Review HealthCheck implementation in internal/container/docker.go:200","status":"closed","priority":1,"issue_type":"bug","owner":"eibrahimov@gmail.com","created_at":"2026-01-15T17:37:29.620068+04:00","created_by":"Edgar I.","updated_at":"2026-01-15T17:52:12.050129+04:00","closed_at":"2026-01-15T17:52:12.050129+04:00","close_reason":"Fixed health check race condition: Added TCP port check before HTTP (catches 'connection refused' faster), added diagnostic logging, reduced polling interval from 2s to 1s, added 1s initial delay (start period). Tests pass with container becoming healthy in 1-2 attempts."}
{"id":"demo-multi-plexer-4of","title":"Implement NATS Queue","description":"Implement Publisher and Consumer interfaces in internal/queue/nats.go. Use JetStream for durability. Wire in cmd/server/main.go. Config already exists in cfg.Queue.","status":"closed","priority":2,"issue_type":"feature","owner":"eibrahimov@gmail.com","created_at":"2026-01-15T16:45:17.046666+04:00","created_by":"Edgar I.","updated_at":"2026-01-15T22:22:45.543872+04:00","closed_at":"2026-01-15T22:22:45.543872+04:00","close_reason":"Implemented NATS JetStream Publisher and Consumer with TDD, wired into main.go with stub handlers"}
{"id":"demo-multi-plexer-5l9","title":"Implement Podman + CRIU Runtime","description":"Implement Runtime interface in internal/container/podman.go. Methods: RestoreFromCheckpoint, Start, Stop, Inspect, HealthCheck. Wire mode detection in cmd/server/main.go. Target: 50-200ms restore from checkpoint.","status":"closed","priority":1,"issue_type":"feature","owner":"eibrahimov@gmail.com","created_at":"2026-01-15T16:45:15.869856+04:00","created_by":"Edgar I.","updated_at":"2026-01-15T19:54:22.855662+04:00","closed_at":"2026-01-15T19:54:22.855662+04:00","close_reason":"Podman runtime with CRIU checkpoint/restore implemented. All tests pass. Committed as 140964c."}
{"id":"demo-multi-plexer-6a1","title":"Phase 2: Production Readiness","status":"open","priority":1,"issue_type":"epic","owner":"eibrahimov@gmail.com","created_at":"2026-01-15T16:45:01.62418+04:00","created_by":"Edgar I.","updated_at":"2026-01-15T16:45:01.62418+04:00","dependencies":[{"issue_id":"demo-multi-plexer-6a1","depends_on_id":"demo-multi-plexer-5l9","type":"blocks","created_at":"2026-01-15T16:45:39.011708+04:00","created_by":"Edgar I."},{"issue_id":"demo-multi-plexer-6a1","depends_on_id":"demo-multi-plexer-4of","type":"blocks","created_at":"2026-01-15T16:45:39.061366+04:00","created_by":"Edgar I."},{"issue_id":"demo-multi-plexer-6a1","depends_on_id":"demo-multi-plexer-nlq","type":"blocks","created_at":"2026-01-15T16:45:39.108334+04:00","created_by":"Edgar I."},{"issue_id":"demo-multi-plexer-6a1","depends_on_id":"demo-multi-plexer-x9q","type":"blocks","created_at":"2026-01-15T16:45:39.1555+04:00","created_by":"Edgar I."},{"issue_id":"demo-multi-plexer-6a1","depends_on_id":"demo-multi-plexer-8cv","type":"blocks","created_at":"2026-01-15T16:45:39.203212+04:00","created_by":"Edgar I."},{"issue_id":"demo-multi-plexer-6a1","depends_on_id":"demo-multi-plexer-8pj","type":"blocks","created_at":"2026-01-15T16:45:39.257302+04:00","created_by":"Edgar I."}]}
{"id":"demo-multi-plexer-7hc","title":"Implement Caddy Route Manager","description":"Implement internal/proxy/caddy.go:\n- HTTP client for Caddy admin API (localhost:2019)\n- POST routes dynamically via /config/apps/http/servers/srv0/routes\n- DELETE routes when instances expire\n- Write comprehensive tests","status":"closed","priority":1,"issue_type":"task","owner":"eibrahimov@gmail.com","created_at":"2026-01-15T15:08:31.461959+04:00","created_by":"Edgar I.","updated_at":"2026-01-15T15:21:39.150106+04:00","closed_at":"2026-01-15T15:21:39.150106+04:00","close_reason":"Implemented CaddyRouteManager with Add/Remove/Get/List routes. Unit and mock tests passing."}
{"id":"demo-multi-plexer-7jd","title":"Implement Valkey Repository","description":"Implement internal/store/valkey.go:\n- Connect to Valkey using github.com/valkey-io/valkey-go\n- Implement all Repository interface methods\n- Use LPUSH/LPOP for atomic pool operations\n- Enable keyspace notifications for TTL expiry\n- Write comprehensive tests","status":"closed","priority":1,"issue_type":"task","owner":"eibrahimov@gmail.com","created_at":"2026-01-15T15:08:28.737839+04:00","created_by":"Edgar I.","updated_at":"2026-01-15T15:14:13.436354+04:00","closed_at":"2026-01-15T15:14:13.436354+04:00","close_reason":"Implemented ValkeyRepository with all 17 interface methods, comprehensive tests added"}
{"id":"demo-multi-plexer-8cv","title":"Implement Real Prometheus Metrics","description":"Integrate github.com/prometheus/client_golang. Track: pool size, acquisition latency, container startup time, route operations. Fix placeholder in internal/api/handler.go.","status":"open","priority":2,"issue_type":"task","owner":"eibrahimov@gmail.com","created_at":"2026-01-15T16:45:21.739296+04:00","created_by":"Edgar I.","updated_at":"2026-01-15T16:45:21.739296+04:00"}
{"id":"demo-multi-plexer-8nz","title":"Implement Pool Manager","description":"Implement internal/pool/impl.go:\n- Implement Manager interface\n- Wire up Repository, Runtime, RouteManager\n- Background replenishment loop with watermark triggers\n- Stats reporting\n- Write comprehensive tests","status":"closed","priority":2,"issue_type":"task","owner":"eibrahimov@gmail.com","created_at":"2026-01-15T15:08:32.538553+04:00","created_by":"Edgar I.","updated_at":"2026-01-15T15:24:56.896229+04:00","closed_at":"2026-01-15T15:24:56.896229+04:00","close_reason":"Implemented PoolManager with Acquire, Release, Stats, Replenisher. All tests passing.","dependencies":[{"issue_id":"demo-multi-plexer-8nz","depends_on_id":"demo-multi-plexer-7jd","type":"blocks","created_at":"2026-01-15T15:08:41.737465+04:00","created_by":"Edgar I."},{"issue_id":"demo-multi-plexer-8nz","depends_on_id":"demo-multi-plexer-v51","type":"blocks","created_at":"2026-01-15T15:08:41.785528+04:00","created_by":"Edgar I."},{"issue_id":"demo-multi-plexer-8nz","depends_on_id":"demo-multi-plexer-7hc","type":"blocks","created_at":"2026-01-15T15:08:41.833733+04:00","created_by":"Edgar I."}]}
{"id":"demo-multi-plexer-8pj","title":"Production Validation Fixes","description":"Add TTL to rate limit counters in internal/store/valkey.go. Validate checkpoint path exists when Podman mode enabled. Switch instance IDs from timestamp to UUID.","status":"open","priority":3,"issue_type":"task","owner":"eibrahimov@gmail.com","created_at":"2026-01-15T16:45:22.729296+04:00","created_by":"Edgar I.","updated_at":"2026-01-15T16:45:22.729296+04:00"}
{"id":"demo-multi-plexer-989","title":"Create PrestaShop CRIU checkpoint for fast restore","description":"Create a PrestaShop checkpoint image for CRIU fast restore provisioning.\n\n## Background\nCRIU checkpoint/restore works on macOS Podman (verified with busybox container). However, complex containers with network sockets (like nginx) may fail due to VM limitations.\n\n## Tasks\n1. Set up PrestaShop container on a Linux host (native, not macOS VM)\n2. Wait for PrestaShop to fully initialize\n3. Create CRIU checkpoint: `podman container checkpoint prestashop --export=/path/to/checkpoint.tar.gz`\n4. Test restore and verify PrestaShop works\n5. Document the checkpoint creation process\n\n## Technical Notes\n- CRIU requires root: use `sudo podman checkpoint`\n- macOS Podman VM has socket limitations - may need native Linux for PrestaShop\n- Checkpoint file should be placed at CONTAINER_CHECKPOINT_PATH env var location\n- Tested busybox checkpoint works (47KB, /Users/boss/dev/demo-multi-plexer/checkpoints/busybox-test.tar.gz)\n\n## Acceptance Criteria\n- PrestaShop checkpoint file created and tested\n- Restore completes in \u003c500ms\n- PrestaShop responds to HTTP requests after restore","status":"open","priority":2,"issue_type":"feature","owner":"eibrahimov@gmail.com","created_at":"2026-01-15T22:03:12.38094+04:00","created_by":"Edgar I.","updated_at":"2026-01-15T22:03:12.38094+04:00"}
{"id":"demo-multi-plexer-lkg","title":"Wire Up API Handlers","description":"Replace 501 stubs with real implementations:\n- Inject Pool Manager into Handler\n- Implement acquireDemo (POST /demos)\n- Implement getDemo (GET /demos/:id)\n- Implement releaseDemo (DELETE /demos/:id)\n- Implement extendDemo (POST /demos/:id/extend)\n- Implement listDemos (GET /demos)\n- Implement getStats (GET /stats)\n- Write integration tests","status":"closed","priority":2,"issue_type":"task","owner":"eibrahimov@gmail.com","created_at":"2026-01-15T15:08:33.568296+04:00","created_by":"Edgar I.","updated_at":"2026-01-15T15:28:12.389019+04:00","closed_at":"2026-01-15T15:28:12.389019+04:00","close_reason":"All endpoints implemented: acquire, get, extend, release, status, stats, metrics. Tests passing.","dependencies":[{"issue_id":"demo-multi-plexer-lkg","depends_on_id":"demo-multi-plexer-8nz","type":"blocks","created_at":"2026-01-15T15:08:43.005184+04:00","created_by":"Edgar I."}]}
{"id":"demo-multi-plexer-nlq","title":"End-to-End Integration Tests","description":"Create tests/integration/e2e_test.go. Test full flow: acquire → health check → extend TTL → release. Use real containers (Docker first, then Podman). Skip pattern: require E2E_TEST=1 env var.","status":"closed","priority":1,"issue_type":"task","owner":"eibrahimov@gmail.com","created_at":"2026-01-15T16:45:18.421464+04:00","created_by":"Edgar I.","updated_at":"2026-01-15T17:37:24.6357+04:00","closed_at":"2026-01-15T17:37:24.6357+04:00","close_reason":"E2E tests implemented with build tags, table-driven tests, t.Cleanup(). Tests verify full lifecycle but require working pool. Separate health check issue discovered."}
{"id":"demo-multi-plexer-v51","title":"Implement Docker Runtime","description":"Implement internal/container/docker.go:\n- Implement Runtime interface using Docker SDK\n- This is the dev/fallback mode (no CRIU)\n- Use github.com/docker/docker/client\n- Start, Stop, inspect container operations\n- Write comprehensive tests","status":"closed","priority":1,"issue_type":"task","owner":"eibrahimov@gmail.com","created_at":"2026-01-15T15:08:29.911867+04:00","created_by":"Edgar I.","updated_at":"2026-01-15T15:18:10.676087+04:00","closed_at":"2026-01-15T15:18:10.676087+04:00","close_reason":"Implemented DockerRuntime with Start, Stop, Inspect, HealthCheck. Unit tests passing."}
{"id":"demo-multi-plexer-vbr","title":"Fix Docker network configuration for dev mode","description":"When running 'make dev', containers fail to start with:\n'network demo-net not found'\n\nRoot cause: Default network in config.go is 'demo-net' but Docker Compose creates it as 'deployments_demo-net'.\n\nFix: Change default network to empty string in internal/config/config.go line ~99:\n- Network: getEnv(\"CONTAINER_NETWORK\", \"demo-net\"),\n+ Network: getEnv(\"CONTAINER_NETWORK\", \"\"),\n\nEmpty network = use Docker's default bridge, which works for dev mode.","status":"closed","priority":1,"issue_type":"bug","owner":"eibrahimov@gmail.com","created_at":"2026-01-15T15:45:17.541724+04:00","created_by":"Edgar I.","updated_at":"2026-01-15T15:48:23.737995+04:00","closed_at":"2026-01-15T15:48:23.737995+04:00","close_reason":"Changed default network from 'demo-net' to empty string. Empty network uses Docker's default bridge, avoiding mismatch with Docker Compose naming."}
{"id":"demo-multi-plexer-x9q","title":"Add Structured Logging","description":"Create pkg/logging/logger.go wrapper. Replace all log.Printf calls with leveled structured logging. Add levels: debug, info, warn, error. Use slog (Go 1.21+) or zerolog.","status":"closed","priority":2,"issue_type":"task","owner":"eibrahimov@gmail.com","created_at":"2026-01-15T16:45:19.780413+04:00","created_by":"Edgar I.","updated_at":"2026-01-15T22:54:25.434855+04:00","closed_at":"2026-01-15T22:54:25.434855+04:00","close_reason":"Implemented structured logging using Go's slog. Created pkg/logging with a thin wrapper that adds Fatal() and Nop() helpers. Replaced all 58 log.Printf/Println/Fatalf calls with structured logging throughout the codebase. Added LOG_LEVEL and LOG_FORMAT config."}
{"id":"demo-multi-plexer-yax","title":"Fix E2E and integration test issues","status":"closed","priority":2,"issue_type":"bug","owner":"eibrahimov@gmail.com","created_at":"2026-01-15T18:21:58.712967+04:00","created_by":"Edgar I.","updated_at":"2026-01-15T18:22:05.868426+04:00","closed_at":"2026-01-15T18:22:05.868426+04:00","close_reason":"Fixed two test issues: (1) TestLifecycle t.Cleanup() was inside acquire subtest causing premature cleanup before get/extend subtests ran, (2) Container tests used ports 32xxx which conflicted with running server's port range. Commits: 344200b, 87fbbb2"}
